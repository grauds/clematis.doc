"use strict";(self.webpackChunkclematis_doc=self.webpackChunkclematis_doc||[]).push([[9808],{33471:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"recipe-book/zabbix/jmxmp_setup","title":"Monitoring with JMXMP","description":"All Clematis API are configured to use JMXMP without SSL and authentication, since it is still the","source":"@site/docs/recipe-book/zabbix/jmxmp_setup.md","sourceDirName":"recipe-book/zabbix","slug":"/recipe-book/zabbix/jmxmp_setup","permalink":"/clematis.doc/docs/recipe-book/zabbix/jmxmp_setup","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"proxmox","permalink":"/clematis.doc/docs/tags/proxmox"},{"inline":true,"label":"zabbix","permalink":"/clematis.doc/docs/tags/zabbix"},{"inline":true,"label":"jmxmp","permalink":"/clematis.doc/docs/tags/jmxmp"}],"version":"current","lastUpdatedAt":1754915375000,"frontMatter":{"tags":["proxmox","zabbix","jmxmp"]},"sidebar":"tutorialSidebar","previous":{"title":"Zabbix"},"next":{"title":"Monitoring TrueNAS Scale","permalink":"/clematis.doc/docs/recipe-book/zabbix/truenas_setup"}}');var i=t(74848),s=t(28453);const o={tags:["proxmox","zabbix","jmxmp"]},r="Monitoring with JMXMP",l={},c=[{value:"Setting Up Zabbix Java Gateway and Pollers",id:"setting-up-zabbix-java-gateway-and-pollers",level:2},{value:"Create JMXMP Template",id:"create-jmxmp-template",level:2},{value:"Use JMXMP Template",id:"use-jmxmp-template",level:2}];function d(e){const a={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"monitoring-with-jmxmp",children:"Monitoring with JMXMP"})}),"\n",(0,i.jsxs)(a.p,{children:["All Clematis API are ",(0,i.jsx)(a.a,{href:"/clematis.doc/docs/web-applications/logging/#runtime-diagnostic-with-jmx",children:"configured to use JMXMP without SSL and authentication"}),", since it is still the\ninternal network with Zabbix. For production, we would've used JMXMP with SSL and authentication, of course,\nso if production happens with any of the home projects. This also would mean that we need to use Cloud hosting,\nnot the home network."]}),"\n",(0,i.jsx)(a.h2,{id:"setting-up-zabbix-java-gateway-and-pollers",children:"Setting Up Zabbix Java Gateway and Pollers"}),"\n",(0,i.jsx)(a.p,{children:"For Zabbix to be able to work with JMXMP, the Java Gateway component needs to be set up:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",metastring:'title="On Zabbix server"',children:"sudo apt install zabbix-java-gateway\n"})}),"\n",(0,i.jsx)(a.p,{children:"The required configuration is done in the Zabbix configuration file:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",metastring:'title="On Zabbix server"',children:"sudo nano /etc/zabbix/zabbix_server.conf \n"})}),"\n",(0,i.jsx)(a.p,{children:"Uncomment the following lines:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:'language-title="/etc/zabbix/zabbix_server.conf"',children:"### Option: JavaGateway\n#       IP address (or hostname) of Zabbix Java gateway.\n#       Only required if Java pollers are started.\n#\n# Mandatory: no\n# Default:\nJavaGateway=127.0.0.1\n\n### Option: JavaGatewayPort\n#       Port that Zabbix Java gateway listens on.\n#\n# Mandatory: no\n# Range: 1024-32767\n# Default:\nJavaGatewayPort=10052\n\n### Option: StartJavaPollers\n#       Number of pre-forked instances of Java pollers.\n#\n# Mandatory: no\n# Range: 0-1000\n# Default:\nStartJavaPollers=10\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Add ",(0,i.jsx)(a.code,{children:"jmxremote_optional-repackaged-5.0.jar"})," library to Java Gateway classpath:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",metastring:'title="On Zabbix server"',children:"sudo mv jmxremote_optional-repackaged-5.0.jar /usr/share/zabbix/java-gateway/lib/\n"})}),"\n",(0,i.jsx)(a.p,{children:"Restart the Zabbix Java Gateway:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",metastring:'title="On Zabbix server"',children:"sudo systemctl restart zabbix-java-gateway\n"})}),"\n",(0,i.jsx)(a.h2,{id:"create-jmxmp-template",children:"Create JMXMP Template"}),"\n",(0,i.jsxs)(a.p,{children:["Zabbix has a template for JMX called ",(0,i.jsx)(a.code,{children:"Generic Java JMX"}),", but it is configured to work with RMI protocol,\nthe connection URL template is ",(0,i.jsx)(a.code,{children:"service:jmx:rmi:///jndi/rmi://{HOST.CONN}:{HOST.PORT}/jmxrmi"}),"."]}),"\n",(0,i.jsxs)(a.p,{children:["The easiest way to change the protocol is to create a new template, and change the connection URL\nto ",(0,i.jsx)(a.code,{children:"service:jmx:jmxmp://{HOST.CONN}:{HOST.PORT}"}),"."]}),"\n",(0,i.jsxs)(a.ol,{children:["\n",(0,i.jsxs)(a.li,{children:["Clone the ",(0,i.jsx)(a.code,{children:"Generic Java JMX"})," template in Zabbix UI, I called the clone ",(0,i.jsx)(a.code,{children:"Generic Java JMXMP"}),":","\n",(0,i.jsx)("img",{src:t(22419).A,style:{width:"1200px"},alt:""}),"\n"]}),"\n",(0,i.jsxs)(a.li,{children:["Now go to the ",(0,i.jsx)(a.code,{children:"Items"})," section of the clone, select 'Mass Update' and change URL of all the items to\n",(0,i.jsx)(a.code,{children:"service:jmx:jmxmp://{HOST.CONN}:{HOST.PORT}"}),":","\n",(0,i.jsx)("img",{src:t(10665).A,style:{width:"1200px"},alt:""}),"\n"]}),"\n",(0,i.jsx)(a.li,{children:"There will be 8 more places not editable via mass update, so you need to change them manually. Export\nthe template, change all the URLs, and import it back."}),"\n"]}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(3691).A+"",children:"Download Generic Java JMXMP template"})}),"\n",(0,i.jsx)(a.h2,{id:"use-jmxmp-template",children:"Use JMXMP Template"}),"\n",(0,i.jsxs)(a.p,{children:["Create a new Java application host in Zabbix, and use the ",(0,i.jsx)(a.code,{children:"Generic Java JMXMP"})," template:"]}),"\n",(0,i.jsx)("img",{src:t(5383).A,style:{width:"1200px"},alt:""}),"\n",(0,i.jsx)(a.p,{children:"The host will be able to connect to the JMXMP:"}),"\n",(0,i.jsx)("img",{src:t(5843).A,style:{width:"1200px"},alt:""})]})}function p(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},3691:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/files/generic_jmxmp-f805e581e59f1dcc6588958543e75613.json"},5383:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/adding_jmxmp_template-2744bddc5d48e9f25b3bb288840b8d09.png"},10665:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/changing_template_items-ef8ad3e0ec0416230da7a6b74bb4cdc9.png"},22419:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/cloning_template-f2ea951c4cf3198c4bf12ef70bc12aee.png"},5843:(e,a,t)=>{t.d(a,{A:()=>n});const n=t.p+"assets/images/jmxmp_monitoring-3910a985b8cadc2b8e86fc1a3e5927dc.png"},28453:(e,a,t)=>{t.d(a,{R:()=>o,x:()=>r});var n=t(96540);const i={},s=n.createContext(i);function o(e){const a=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(s.Provider,{value:a},e.children)}}}]);